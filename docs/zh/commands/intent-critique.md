# /intent-critique

> Intent 设计质量的批判性审查

## 用法

```bash
/intent-critique
/intent-critique path/to/INTENT.md
```

## 目的

审查你的 Intent 的设计质量问题，关注：

- 过度工程
- YAGNI（你不会需要它）违规
- 过早抽象
- 不必要的复杂性

这是一个交互式讨论，用于改进设计决策。

## 何时使用

- `/intent-interview` 后批准前
- 当 Intent 感觉太复杂时
- 在开始实现大型功能之前
- 当你想对设计选择获得第二意见时

## 检查内容

### 过度工程检测

| 模式 | 示例 | 更好的做法 |
|------|------|----------|
| 太多抽象 | 简单 CRUD 用 5 层 | 最多 2-3 层 |
| 过早泛化 | "支持任何数据类型" | 从具体类型开始 |
| 配置过度 | 20 个配置选项 | 合理默认值 |
| 未来防护 | "以防我们需要 X" | 需要时再构建 X |

### YAGNI 违规

- 不在当前需求中的功能
- 没人要求的灵活性
- 伪装成需求的"锦上添花"

### 复杂性分析

- 圈复杂度提示
- 依赖数量
- 接口表面积

## 交互过程

批判是讨论，不是报告。它会：

1. **识别关注点** - 指出潜在问题
2. **提出问题** - "你真的需要 X 吗？"
3. **建议简化** - "如果我们只是..."
4. **寻求理由** - "为什么这是必要的？"

## 示例会话

```
> /intent-critique intent/payment-processor/INTENT.md

审查 Intent 的设计质量...

## 关注点 1：抽象层

你的 Intent 定义了一个有 15 个方法的 PaymentProviderInterface。

当前需求只提到 Stripe 集成。

**问题：** 你有其他提供商的具体计划吗？

> 我们可能以后会添加 PayPal

**建议：** 从直接的 Stripe 集成开始。当你实际添加 PayPal 时再
提取接口。那时正确的抽象会更清晰。

## 关注点 2：配置复杂性

你的 Intent 指定了 12 个配置选项，包括：
- retryStrategy
- circuitBreakerThreshold
- customWebhookParser

**问题：** 这些是由实际需求驱动的还是"以防万一"？

> 重试策略很重要，其他的是锦上添花

**建议：** 保留 retryStrategy。移除其他的直到需要。
更简单的配置 = 更少的 bug。

## 关注点 3：事件系统

你为支付事件设计了一个完整的事件总线。

当前用例：成功支付后发送邮件。

**建议：** 直接函数调用更简单。当你有 3 个以上订阅者时
再添加事件总线。

## 总结

| 问题 | 严重性 | 建议 |
|------|--------|------|
| PaymentProviderInterface | 中 | 推迟抽象 |
| 配置复杂性 | 低 | 移除 12 个选项中的 10 个 |
| 事件系统 | 中 | 使用直接调用 |

接受简化？[y/n/讨论]
```

## 批判理念

> "最好的代码是没有代码。第二好的是简单代码。"

批判遵循以下原则：

1. **YAGNI** - 不要构建今天不需要的东西
2. **先简单** - 从简单开始，在证明必要时再增加复杂性
3. **先具体后抽象** - 先有真实示例再泛化
4. **三次原则** - 在第三个类似情况后再提取抽象

## 相关命令

- [/intent-interview](intent-interview.md) - 先创建 Intent
- [/intent-review](intent-review.md) - 批判后批准
- [/intent-changes](intent-changes.md) - 提议具体变更

## 另请参阅

- [IDD 工作流程](../workflow.md) - 批判的位置
- [方法论](../methodology.md) - IDD 理念
